{"componentChunkName":"component---src-templates-blog-post-js","path":"/csr-ssr/","result":{"data":{"site":{"siteMetadata":{"title":"동수의 로그북"}},"markdownRemark":{"id":"de484233-fc1b-5c1b-af93-024548991298","excerpt":"들어가며 근래에 Next.js와 함께 Server-Side-Rendering에 대한 인기가 매우 뜨겁다는걸 느낍니다. 18 버전 이전의 과거 React는 모두 브라우저에서 렌더링을 했었지만 React 18 이상에서는 reactDOM이 client / server…","html":"<h2 id=\"들어가며\" style=\"position:relative;\">들어가며<a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\" aria-label=\"들어가며 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>근래에 Next.js와 함께 Server-Side-Rendering에 대한 인기가 매우 뜨겁다는걸 느낍니다.</p>\n<p>18 버전 이전의 과거 React는 모두 브라우저에서 렌더링을 했었지만 React 18 이상에서는 reactDOM이 client / server로 분리되었고,</p>\n<p>client에서 할 수 있는 rendering과 server에서 할 수 있는 rendering을 분리하고 있습니다.</p>\n<p><a href=\"https://github.com/facebook/react/blob/main/CHANGELOG.md#1800-march-29-2022\">자세한 사항은 여기를 클릭하세요.</a></p>\n<p>이런 시대적인 상황에 맞춰서 직접 구현해보며 이해를 확실히 하고자 합니다.</p>\n<h2 id=\"목표\" style=\"position:relative;\">목표<a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>우리의 목표는 버튼을 클릭했을 때 박스 내부의 background-color가 변경되는 코드를 CSR, SSR로 구현하는 것입니다.</p>\n<iframe class=\"example-frame\" width=\"100%\" height='330px' src=\"https://sonicce99.github.io/learn-csr-ssr/csr/index.html\"></iframe>\n<p>배경 바꾸기 버튼을 클릭해보세요.</p>\n<p>배경 색깔이 빨간색, 초록색으로 toggle 되는걸 확인 할 수 있습니다.</p>\n<h2 id=\"구현\" style=\"position:relative;\">구현<a href=\"#%EA%B5%AC%ED%98%84\" aria-label=\"구현 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"csr\" style=\"position:relative;\">CSR<a href=\"#csr\" aria-label=\"csr permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>제가 생각했을 때 CSR을 가장 직관적으로 이해할 수 있다고 생각한 사진입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1fd9f8d905598612cb74a52da3f779d4/d4b10/csr.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.14723926380368%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVR42mVRW07DMBDM/Q+B+OIOkXqAQgtC0NCHEwF5NFKrOHISv+NdlLpYoeyH5fHOeMfjCBEppcvlsq5rRAQA/FsAYK0FAK31TTdCRGst53wcx7kgrJTSOI6TJInjmDE2HxABgHMuyMZxDD2/UUqlaVqW5Xa7tdZ6zu9kAC6EkMpja63WWik1tyelFEIEKITwhMl2UR3XL68AIKXUWn9955vkw1+hlNJa5Xn+9r7hnPuTsqw2yeQiklJW1XF/IH3fef3j0+pAiLfnnJNSrtbPhGTuUhNcrXe7PQBEXde1bcsYo5R6h3Vdn04nH4QxJssyQlJCSFEUiOiZ53PDOZ9sO+fmUfuBc2gvFTifedE21fXNwzA0DQ3xtm07DMM8MMaYMcZ/ACLe3T/Ei8VVbIzxHxjC/C/mnAfYM9b3E+EHNJM+cyvmzHIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CSR\"\n        title=\"\"\n        src=\"/static/1fd9f8d905598612cb74a52da3f779d4/a6d36/csr.png\"\n        srcset=\"/static/1fd9f8d905598612cb74a52da3f779d4/222b7/csr.png 163w,\n/static/1fd9f8d905598612cb74a52da3f779d4/ff46a/csr.png 325w,\n/static/1fd9f8d905598612cb74a52da3f779d4/a6d36/csr.png 650w,\n/static/1fd9f8d905598612cb74a52da3f779d4/e548f/csr.png 975w,\n/static/1fd9f8d905598612cb74a52da3f779d4/3c492/csr.png 1300w,\n/static/1fd9f8d905598612cb74a52da3f779d4/d4b10/csr.png 1394w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>총 4개의 단계가 있는데 그 중에 3단계가 Loading 중입니다.</p>\n<p>아무래도 초기에 javascript 번들을 많이 로드해야하다보니 SSR보다 느리다는 단점이 있는것 같습니다.</p>\n<p>SEO에 좋지 않다. 등 단점이 있지만 새로고침이 없다, interactive 하다는 장점들도 존재하죠.</p>\n<p>본격적으로 들어가 보겠습니다!</p>\n<h4 id=\"폴더-구조\" style=\"position:relative;\">폴더 구조<a href=\"#%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0\" aria-label=\"폴더 구조 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">csr\n├── index.html    #root El 존재\n├── component.js  #root El에 주입할 컴포넌트\n└── index.js      #render 함수 존재</code></pre></div>\n<h4 id=\"제약사항\" style=\"position:relative;\">제약사항<a href=\"#%EC%A0%9C%EC%95%BD%EC%82%AC%ED%95%AD\" aria-label=\"제약사항 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<ol>\n<li>\n<p>components를 분리하고 모듈화 하기 위해 index.html 내부의 &#x3C;script> 태그는 type=‘module’로 선언합니다.</p>\n</li>\n<li>\n<p>추후에 SSR에서 hydration 과정을 보기 위해 CSR에서도 css는 css-in-js 방식을 사용합니다.</p>\n</li>\n</ol>\n<h4 id=\"code\" style=\"position:relative;\">Code<a href=\"#code\" aria-label=\"code permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<h5 id=\"indexhtml\" style=\"position:relative;\">index.html<a href=\"#indexhtml\" aria-label=\"indexhtml permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token constant\">DOCTYPE</span> html<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>html lang<span class=\"token operator\">=</span><span class=\"token string\">\"ko\"</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>meta charset<span class=\"token operator\">=</span><span class=\"token string\">\"UTF-8\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>meta http<span class=\"token operator\">-</span>equiv<span class=\"token operator\">=</span><span class=\"token string\">\"X-UA-Compatible\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"IE=edge\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>meta name<span class=\"token operator\">=</span><span class=\"token string\">\"viewport\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"width=device-width, initial-scale=1.0\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span><span class=\"token constant\">CSR</span> <span class=\"token operator\">|</span> 동수의 로그북<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">\"root\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>script type<span class=\"token operator\">=</span><span class=\"token string\">\"module\"</span> src<span class=\"token operator\">=</span><span class=\"token string\">\"./index.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span></code></pre></div>\n<p>CSR의 &#x3C;body> 태그에는 root와 &#x3C;script> 하나만이 존재할 뿐입니다.</p>\n<h5 id=\"componentjs\" style=\"position:relative;\">component.js<a href=\"#componentjs\" aria-label=\"componentjs permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Content <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n&lt;h1>CSR을 배워보자&lt;/h1>\n&lt;div id='canvas'>&lt;/div>\n&lt;button id='btn'>배경 바꾸기&lt;/button>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>단순히 index.html에 주입되는 viewModel일 뿐입니다.</p>\n<p>canvas라는 div 태그 하나와 btn이라는 버튼이 하나 존재합니다.</p>\n<h5 id=\"indexjs\" style=\"position:relative;\">index.js<a href=\"#indexjs\" aria-label=\"indexjs permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Content <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./component.js\"</span>\n\n<span class=\"token keyword\">let</span> isColorGreen <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">render</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $root <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span>\n  $root<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> Content\n  $root<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> $canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"canvas\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isColorGreen<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      $canvas<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">\"red\"</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      $canvas<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">\"green\"</span>\n    <span class=\"token punctuation\">}</span>\n\n    isColorGreen <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>isColorGreen\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>여기 view가 있습니다.</p>\n<p>동작은 단순합니다. canvas 박스의 색깔이 초록색인지 판별하는 isColorGreen 변수가 있고</p>\n<p>배경 바꾸기 버튼이 클릭되었을 때 canvas 배경이 초록색이면 빨간색으로 바꾸고 빨간색이면 초록색으로 바꿉니다.</p>\n<p>맨 처음에 목표 파트에서 보았던 것처럼 아주 잘 동작하는 것을 볼 수 있습니다. 👍🏻 👍🏻</p>\n<iframe class=\"example-frame\" width=\"100%\" height='330px' src=\"https://sonicce99.github.io/learn-csr-ssr/csr/index.html\"></iframe>\n<h4 id=\"javascript-사용-중지\" style=\"position:relative;\">Javascript 사용 중지<a href=\"#javascript-%EC%82%AC%EC%9A%A9-%EC%A4%91%EC%A7%80\" aria-label=\"javascript 사용 중지 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>하지만 만약 javascript를 사용중지 한다면 어떻게 될까요?</p>\n<p>javascript 사용중지는 Chrome의 경우</p>\n<p><strong>개발자 도구 > 설정 > 환경설정 > 디버거</strong></p>\n<p>에 있습니다.</p>\n<iframe class=\"example-frame\" width=\"100%\" height='550px' src=\"https://user-images.githubusercontent.com/87749134/218673327-f5bdd8ba-ca18-44e5-ba81-0ac8dc23eda6.gif\"></iframe>\n<p>당연한 이야기이겠지만 javascript 동작을 중지한다면 내부의 canvas와 button은 사라지고 아무것도 할 수 없게 됩니다.</p>\n<p>개발자도구의 Element에서도 찾아볼 수 없죠.</p>\n<h3 id=\"ssr\" style=\"position:relative;\">SSR<a href=\"#ssr\" aria-label=\"ssr permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>SSR은 어떨까요? 서버에서 렌더링된 페이지를 전달 받으니, 브라우저에서 javascript 동작 중지를 한다고 해도 client는 화면을 볼 수 있지 않을까요?</p>\n<p>물론 배경 바꾸기 버튼을 클릭해도 배경은 바뀌지 않겠지만요.</p>\n<p>정말 그럴까요?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e79cf6db1ff033bcb1ce0309a7a5288c/bb3b7/ssr.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.14723926380368%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABV0lEQVR42o2RXW+CMBSG/ftLtmXJfoY/wkSdiRdkmTo04lTQISClxdEPeihnwyoxu9neiyan7XM+3tNBRELIeDxOkgQR67rGf6uDiEqpNE3LskRESqnneYSQ+XwOAH/Dtpo9oyju9weO4/R6Pa21vTfGtMBtaCuX9h8iVlUlpBRSIiIAeJ6nlJJS3nYhhLBhA4eHyHl9M8Zwzmtj3t3FzF00IzDW7XYPURSGh+VyBVf5QfCx3jSwMSZJjktvpbU2xgDAfh9u/d25u6a9oigGL6P1eqO1BgBCsuFwtPX9BpZSHs9ijCFiHMeTydR155RSRJRShWGYpmkcJ1mWISLnnKRpltGqqjq/PNBaM8by0wmuLmiodp+BkoVdoqkxCPeCs8vMTTKStX4wxoQQrf+Ufd3dPwU7377KEh4en2fu9AIDQJ7nLczPakOlpL/ZFly0q8opFVL9wN9fyjtfpjp0YwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SSR\"\n        title=\"\"\n        src=\"/static/e79cf6db1ff033bcb1ce0309a7a5288c/a6d36/ssr.png\"\n        srcset=\"/static/e79cf6db1ff033bcb1ce0309a7a5288c/222b7/ssr.png 163w,\n/static/e79cf6db1ff033bcb1ce0309a7a5288c/ff46a/ssr.png 325w,\n/static/e79cf6db1ff033bcb1ce0309a7a5288c/a6d36/ssr.png 650w,\n/static/e79cf6db1ff033bcb1ce0309a7a5288c/e548f/ssr.png 975w,\n/static/e79cf6db1ff033bcb1ce0309a7a5288c/bb3b7/ssr.png 1211w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>위의 사진을 보면 2번 단계에서 3번 단계로 갈 때 서버는 이미 HTML 파일을 브라우저로 전송하고 사용자는 볼 수 있다고 했습니다.</p>\n<p>Visible 하지만 not interactive라고 사진에 설명이 되어 있네요.</p>\n<p>한번 구현해보며 확인해보겠습니다!</p>\n<h4 id=\"폴더-구조-1\" style=\"position:relative;\">폴더 구조<a href=\"#%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0-1\" aria-label=\"폴더 구조 1 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ssr\n├── package-lock.json\n├── package.json        #express 설치를 위한 npm package 설치\n├── server.js           #express 서버를 위한 코드\n└── src\n    ├── component.js    #CSR과 동일\n    ├── hydrateRoot.js  #javascript를 동작시키기 위한 코드 (CSR의 index.js와 동일)\n    └── template.js     #서버에서 html을 받기위한 템플릿</code></pre></div>\n<h4 id=\"제약사항-1\" style=\"position:relative;\">제약사항<a href=\"#%EC%A0%9C%EC%95%BD%EC%82%AC%ED%95%AD-1\" aria-label=\"제약사항 1 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<ol>\n<li>\n<p>server를 사용해야하기 때문에 npm project로 실행해야하며 express를 설치합니다.</p>\n</li>\n<li>\n<p>commonJS에서는 import, export 구문을 사용할 수 없음으로 require, module.exports를 통해 모듈을 가져오고 내보냅니다.</p>\n</li>\n<li>\n<p>server에서 HTML을 만들고 전송하기 때문에 index.html이 필요하지 않습니다.</p>\n</li>\n</ol>\n<h4 id=\"code-1\" style=\"position:relative;\">Code<a href=\"#code-1\" aria-label=\"code 1 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<h5 id=\"srccomponentjs\" style=\"position:relative;\">src/component.js<a href=\"#srccomponentjs\" aria-label=\"srccomponentjs permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n&lt;h1>SSR을 배워보자&lt;/h1>\n&lt;div id='canvas' style='width: 300px; height: 200px; border: 3px solid red;'>&lt;/div>\n&lt;button id='btn'>배경 바꾸기&lt;/button>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>CSR과 완전히 동일합니다.</p>\n<p>다만 서버에서 실행되다보니 es6의 export로 내보내지 않고 module.exports를 통해 내보냅니다.</p>\n<h5 id=\"srchydraterootjs\" style=\"position:relative;\">src/hydrateRoot.js<a href=\"#srchydraterootjs\" aria-label=\"srchydraterootjs permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> isColorGreen <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">hydrateRoot</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $btn <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"btn\"</span><span class=\"token punctuation\">)</span>\n  $btn<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> $canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"canvas\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isColorGreen<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      $canvas<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">\"red\"</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      $canvas<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token string\">\"green\"</span>\n    <span class=\"token punctuation\">}</span>\n\n    isColorGreen <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>isColorGreen\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">hydrateRoot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>CSR에서 index.js와 100% 동일한 코드입니다.</p>\n<p>하지만 render에서 hydratinRoot라는 함수로 명칭이 바뀌었네요.</p>\n<p>왜 바뀌었는지 더 밑에서 알아보겠습니다.</p>\n<h5 id=\"srctemplatejs\" style=\"position:relative;\">src/template.js<a href=\"#srctemplatejs\" aria-label=\"srctemplatejs permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> component <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./component\"</span><span class=\"token punctuation\">)</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;!DOCTYPE html>\n&lt;html lang=\"ko\">\n  &lt;head>\n    &lt;meta charset=\"UTF-8\" />\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    &lt;title>SSR | 동수의 로그북&lt;/title>\n  &lt;/head>\n  &lt;body>\n    &lt;div id=\"root\">\n        </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>component<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n    &lt;/div>\n    &lt;script src='./hydrateRoot.js'>&lt;/script>\n  &lt;/body>\n&lt;/html>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>component를 받아와서 HTML 파일을 만들고 해당 템플릿 리터럴을 내보냅니다.</p>\n<p>역시나 서버에서 만드는 동작이므로 역시나 require, module.exports를 합니다.</p>\n<p>🌟 다만 여기서 알아야될 한가지는 &#x3C;script> 태그입니다.</p>\n<p>hydrateRoot.js는 배경 바꾸기 버튼을 클릭했을 떄 배경을 바꿔주는 javascript 파일입니다.</p>\n<p>하지만 템플릿 리터럴을 통해 &#x3C;script>를 내보내면 hydrateRoot.js는 정상적으로 동작하지 않습니다.</p>\n<p>이 과정은 hydration이라는 과정을 거쳐야하는데 더 밑에서 알아보도록 하겠습니다.</p>\n<p>이렇게 만든 HTML string은 어디로 보내야 할까요?</p>\n<p>서버로 보내야겠죠?</p>\n<h5 id=\"serverjs\" style=\"position:relative;\">server.js<a href=\"#serverjs\" aria-label=\"serverjs permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h5>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> <span class=\"token number\">7777</span>\n\n<span class=\"token keyword\">const</span> templateHtml <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./src/template\"</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>templateHtml<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Example app listening on port </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>templateHtml이라는 아까 만들어둔 템플릿 리터널 HTML을 받아오고 client가 ’/’ 라우터를 타게되면 해당 HTML을 response 해줍니다.</p>\n<p>이렇게 하면 어떻게 될까요? 서버에서 HTML이 왔으니 브라우저에서 javascript 동작 중지를 하고 새로고침을 하더라도 일단 HTML이 렌더링 되지 않을까요?</p>\n<p>확인해봅시다!</p>\n<iframe class=\"example-frame\" width=\"100%\" height='550px' src=\"https://user-images.githubusercontent.com/87749134/218909930-69ab4b18-55fb-403e-a0a2-d909fbd07272.gif\"></iframe>\n<p>위애서 몇 번 언급했던 대로 배경 바꾸기 버튼을 클릭해도 색깔이 변경되지 않는것을 확인합니다.</p>\n<p>디버거에서 javascript 동작 중지를 하고 새로고침을 하더라도 client은 일단 렌더링된 화면을 볼 수 있습니다!! 😆</p>\n<p>자 그러면 이제 버튼 클릭 시 canvas의 색깔을 바꿀 수 있게 해주어야겠죠?</p>\n<h4 id=\"hydraion\" style=\"position:relative;\">hydraion<a href=\"#hydraion\" aria-label=\"hydraion permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>hydration이 무슨 뜻일까요?</p>\n<p>네이버에 찾아보니 이러한 그림이 나옵니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f087b12c20f4197a1119dad6836f717f/15ec7/hydration.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.21472392638037%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAEDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHXSSwL/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECIiEyQv/aAAgBAQABBQJOzlbAtuz/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAQATH/2gAIAQEABj8CMKf/xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhQTFhcf/aAAgBAQABPyHJDU4moeEJZ7lFkFqf/9oADAMBAAIAAwAAABC7D//EABYRAAMAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxClf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAMBAQEBAAAAAAAAAAAAAAERIQAxUWH/2gAIAQEAAT8QkiBIodzrFPYsZOkKo79wQQp0ylWOo7//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Hydration\"\n        title=\"\"\n        src=\"/static/f087b12c20f4197a1119dad6836f717f/6aca1/hydration.jpg\"\n        srcset=\"/static/f087b12c20f4197a1119dad6836f717f/d2f63/hydration.jpg 163w,\n/static/f087b12c20f4197a1119dad6836f717f/c989d/hydration.jpg 325w,\n/static/f087b12c20f4197a1119dad6836f717f/6aca1/hydration.jpg 650w,\n/static/f087b12c20f4197a1119dad6836f717f/15ec7/hydration.jpg 690w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>어떤 용매가 용액 속에서 용질 분자나 이온을 둘러싼 채, 그 전체가 하나의 분자처럼 행동하는 현상을 보일 때, 용질 분자나 이온이 용매화되었다고 말하며, 용매가 물인 경우를 특별히 hydraion라고 말한다.</strong></p>\n<p>라고 되어 있습니다.</p>\n<p>중요한 말은 <em>그 전체가 하나의 분자처럼 행동하는 현상</em> 인 것 같습니다.</p>\n<p>그럼 개발 용어에서 hydration은 뭘까요?</p>\n<p><strong>바로 Server Side단에서 렌더링 된 정적 페이지와 번들링된 js파일을 client에게 보낸 뒤, client 단에서 HTML 코드와 React인 js 코드를 서로 매칭시키는 과정을 말합니다.</strong></p>\n<p>바로 정적인 HTML을 interactive 하게 javascript를 입혀주는 과정이겠네요.</p>\n<p>React 17버전까지는 hydrate() 라는 함수가 있었지만,</p>\n<p>18버전 부터는 reactDOM이 client / server로 나눠지게 되면서 hydrateRoot() 라는 함수로 이름이 변경되었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 17버전 까지</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> hydrate <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span>\n\n<span class=\"token function\">hydrate</span><span class=\"token punctuation\">(</span>reactNode<span class=\"token punctuation\">,</span> domNode<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 18버전 부터</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> hydrateRoot <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom/client\"</span>\n\n<span class=\"token keyword\">const</span> domNode <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> <span class=\"token function\">hydrateRoot</span><span class=\"token punctuation\">(</span>domNode<span class=\"token punctuation\">,</span> reactNode<span class=\"token punctuation\">)</span></code></pre></div>\n<p><a href=\"https://beta.reactjs.org/reference/react-dom/client/hydrateRoot\">hydrateRoot에 대한 자세한 내용은 여기를 클릭하세요</a></p>\n<p>하지만 지금은 react로 hydration 작업을 하는게 아니고 vanilla javascript로 해야하니 이런 것들을 사용할 수 없겠지요.</p>\n<p>어떻게 해야할까요?</p>\n<p>바로 server.js를 아래와 같이 고치면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> <span class=\"token number\">7777</span>\n\n<span class=\"token keyword\">const</span> templateHtml <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./src/template\"</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>templateHtml<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">static</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"src\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Example app listening on port </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>특별히 바뀐 것은 없습니다. 단지 express.static이 추가되었고 매개변수로 ‘src’를 전달하면 됩니다.</p>\n<p>express.static을 사용하면 이미지, CSS 파일 및 JavaScript 파일과 같은 정적 파일을 제공할 수 있습니다.</p>\n<p>아까 src/template.js에서 아래와 같은 &#x3C;script> 가 있었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token string\">\"./hydrateRoot.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></code></pre></div>\n<p>app.use(express.static(“src”)) 을 설정하면 express는 해당 hydrateRoot.js를 실행 시키기위해 src 내부에 있는 파일을 순차적으로 검색합니다.</p>\n<p>hydrateRoot.js 파일이 src 내부에 있으니 정상 동작 하겠지요.</p>\n<p>최종 동작입니다.</p>\n<iframe class=\"example-frame\" width=\"100%\" height='550px' src=\"https://user-images.githubusercontent.com/87749134/218919654-4ad7d8ed-23d6-4686-b97f-9c9d7858dc3b.gif\"></iframe>\n<p>client는 브라우저에서 javascript 동작 중지를 하고 새로고침을 해도 렌더링된 정적 파일을 미리 볼 수 있습니다.</p>\n<p>다시 javascript 동작 중지를 해제한 후에 다시 새로고침해보면 사용자는 hydtation까지 된 최종 CSR과 같은 결과를 볼 수 있습니다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\">마치며<a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>저 역시도 명확하게 그려지지 않았던 부분을 직접 구현해보고 여러 블로그를 찾아보고 블로그를 써보며 더 확실히 개념을 적립할 수 있었던 그런 포스팅이였던 것 같습니다.</p>\n<p>또한 지금은 vanilla javascript로 구현했지만 한 단계 더 나아가 추후에 React로도 구현해보면 더 좋은 공부가 될 것 같습니다.</p>\n<p>혹시나 내용이 잘못된 부분이 있다면 <a href=\"mailto:sonicce99@naver.com\">sonicce99@naver.com</a> 으로 알려주세요.</p>\n<p><a href=\"https://github.com/sonicce99/learn-csr-ssr\">해당 블로그의 code repository는 여기를 클릭하셔서 보시면 됩니다.</a></p>\n<p>긴 글을 읽어주셔서 감사합니다.</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\">들어가며</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B5%AC%ED%98%84\">구현</a></p>\n<ul>\n<li>\n<p><a href=\"#csr\">CSR</a></p>\n<ul>\n<li>\n<p><a href=\"#%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0\">폴더 구조</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A0%9C%EC%95%BD%EC%82%AC%ED%95%AD\">제약사항</a></p>\n</li>\n<li>\n<p><a href=\"#code\">Code</a></p>\n<ul>\n<li><a href=\"#indexhtml\">index.html</a></li>\n<li><a href=\"#componentjs\">component.js</a></li>\n<li><a href=\"#indexjs\">index.js</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#javascript-%EC%82%AC%EC%9A%A9-%EC%A4%91%EC%A7%80\">Javascript 사용 중지</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#ssr\">SSR</a></p>\n<ul>\n<li>\n<p><a href=\"#%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0-1\">폴더 구조</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A0%9C%EC%95%BD%EC%82%AC%ED%95%AD-1\">제약사항</a></p>\n</li>\n<li>\n<p><a href=\"#code-1\">Code</a></p>\n<ul>\n<li><a href=\"#srccomponentjs\">src/component.js</a></li>\n<li><a href=\"#srchydraterootjs\">src/hydrateRoot.js</a></li>\n<li><a href=\"#srctemplatejs\">src/template.js</a></li>\n<li><a href=\"#serverjs\">server.js</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#hydraion\">hydraion</a></p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n</ul>","frontmatter":{"title":"Vanilla javascript로 CSR, SSR 구현하기","date":"February 15, 2023","description":"SSR를 vanilla javascript로 직접 구현하고 그 과정을 이해합니다.","keywords":["react","javascript","자바스크립트","csr","ssr"]}},"previous":{"fields":{"slug":"/redux-toolkit/"},"frontmatter":{"title":"Redux-toolkit 공식문서 뿌시기"}},"next":{"fields":{"slug":"/react-query/"},"frontmatter":{"title":"React Query 공식문서 번역본"}}},"pageContext":{"id":"de484233-fc1b-5c1b-af93-024548991298","previousPostId":"7250f432-4968-51f3-9519-919810b9487b","nextPostId":"9364d098-7ddf-53c5-94f0-621ec77f11b4"}},"staticQueryHashes":["230163734","2664618587"],"slicesMap":{}}