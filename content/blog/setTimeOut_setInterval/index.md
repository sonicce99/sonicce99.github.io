---
title: "setTimeoutìœ¼ë¡œ Polling êµ¬í˜„í•˜ê¸°"
date: "2022-06-12"
description: "ì‚¬ìš©ìê°€ ì£¼ë¬¸ ì‹œìŠ¤í…œ(OMS)ì— ì—…ë¡œë“œí•œ ì£¼ë¬¸ ë°ì´í„°ë¥¼ ì°½ê³ ê´€ë¦¬ ì‹œìŠ¤í…œ(WMS)ìœ¼ë¡œ ì „ì†¡í• ë•Œ ëŒ€ëŸ‰ì˜ ì£¼ë¬¸ê±´ì¸ ê²½ìš°(300ê±´ ì´ìƒ), ì›í™œíˆ ì „ì†¡í•˜ì§€ ëª»í•˜ë˜ ê¸°ì¡´ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ê°œì„ í•˜ëŠ” ê³¼ì •ì—ì„œ ì–»ê²Œëœ ê¹¨ë‹¬ìŒì— ê´€í•œ ì´ì•¼ê¸°ì…ë‹ˆë‹¤. "
keywords: [react, ìë°”ìŠ¤í¬ë¦½íŠ¸, javascript, closure, setTimeout, setInterval]
---

## ë“¤ì–´ê°€ë©° ğŸ‘‹ğŸ»

í’€í•„ë¨¼íŠ¸ ì„œë¹„ìŠ¤ íšŒì‚¬ì´ê¸° ë•Œë¬¸ì— íšŒì‚¬ì—ëŠ” 2ê°€ì§€ ì‹œìŠ¤í…œì´ ìˆìŠµë‹ˆë‹¤. í•˜ë‚˜ëŠ” `ì£¼ë¬¸ê´€ë¦¬ì‹œìŠ¤í…œ` (Order Management Sysyem), ë˜ ë‹¤ë¥¸ í•˜ë‚˜ëŠ” `ì°½ê³ ê´€ë¦¬ì‹œìŠ¤í…œ` (Warehouse Management Sysyem) ì…ë‹ˆë‹¤. ê¸°ì¡´ì˜ ì£¼ë¬¸ ì „ì†¡ ë°©ì‹ì€ ëŒ€ëŸ‰ì˜ ì—…ë¡œë“œ ê±´ì„ ì²˜ë¦¬í•˜ëŠ”ë° ë¬¸ì œê°€ ë§ì•˜ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ê¸°ì¡´ì—ëŠ” ì—…ë¡œë“œí•  ë°ì´í„°ë¥¼ ì†ŒëŸ‰ì”© ì§¤ë¼ì„œ dispatch í–ˆë‹¤ë©´, ìƒˆë¡œìš´ ë°©ì‹ìœ¼ë¡œëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ í•œë²ˆì— ì „ì†¡í•˜ê³  batchNumberë¥¼ ê°€ì§€ê³  ì§€ì†ì ìœ¼ë¡œ `polling` í•˜ë©´ì„œ ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬ì¶•í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.

## polling?

ìƒì†Œí•˜ì‹  ë¶„ë“¤ë„ ìˆìœ¼ë¦¬ë¼ ìƒê°ë©ë‹ˆë‹¤. ì € ì—­ì‹œ ìƒì†Œí•œ ë‹¨ì–´ì˜€ëŠ”ë°ìš”. ìœ„í‚¤ ë°±ê³¼ì—ì„œ ì°¾ì€ pollingì˜ ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

ğŸƒ : **í´ë§(polling)** ì´ë€ í•˜ë‚˜ì˜ ì¥ì¹˜(ë˜ëŠ” í”„ë¡œê·¸ë¨)ê°€ ì¶©ëŒ íšŒí”¼ ë˜ëŠ” ë™ê¸°í™” ì²˜ë¦¬ ë“±ì„ ëª©ì ìœ¼ë¡œ ë‹¤ë¥¸ ì¥ì¹˜(ë˜ëŠ” í”„ë¡œê·¸ë¨)ì˜ ìƒíƒœë¥¼ **ì£¼ê¸°ì ìœ¼ë¡œ ê²€ì‚¬** í•˜ì—¬ ì¼ì •í•œ ì¡°ê±´ì„ ë§Œì¡±í•  ë•Œ ì†¡ìˆ˜ì‹  ë“±ì˜ ìë£Œì²˜ë¦¬ë¥¼ í•˜ëŠ” ë°©ì‹ì„ ë§í•œë‹¤.

## ì–´ë–»ê²Œ ì£¼ê¸°ì ìœ¼ë¡œ ê²€ì‚¬í•´ì•¼ í• ê¹Œ?

ê²°ë¡ ì ìœ¼ë¡œ ë§í•˜ë©´ ì—¬ëŸ¬ ë°©ë²•ì´ ìˆê² ì§€ë§Œ ì œê°€ ìƒê°í•œ ë°©ë²•ì—ëŠ” 3ê°€ì§€ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

- setInterval

- setTimeout

- useInterval

ì£¼ê¸°ì ìœ¼ë¡œ íŠ¹ì • callback í•¨ìˆ˜ë¥¼ ì‹¤í–‰ ì‹œí‚¬ ìˆ˜ ìˆë‹¤ë©´ serverì— ì§€ì†ì ìœ¼ë¡œ ë°ì´í„°ê°€ ëª¨ë‘ ì²˜ë¦¬ ë˜ì—ˆëŠ”ì§€ ì§ˆì˜í•´ ë³¼ ìˆ˜ ìˆê² ë‹¤ëŠ” ê²°ë¡ ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.
3ê°€ì§€ ë°©ë²•ì„ ëª¨ë‘ ê³ ë ¤í•´ ë³´ê³  ì–´ë–¤ ê²ƒì´ ê°€ì¥ ì¢‹ì„ì§€ ìƒê°í•´ë³´ì•˜ëŠ”ë° ì•„ë˜ì—ì„œ ì°¬ì°¬íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

### setInterval ê³¼ setTimeoutì˜ ì°¨ì´?

ì–´ë–¤ í•¨ìˆ˜ë¥¼ ì„ íƒí•´ì•¼ ê°€ì¥ ìµœê³ ì˜ ì„ íƒì¼ê¹Œìš”? ë¬¼ë¡  ì›í•˜ëŠ” ë™ì‘ë§ˆë‹¤ ë‹¤ë¥´ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.

í•˜ì§€ë§Œ ê²°ì •ì ì¸ ì°¨ì´ëŠ” ë°”ë¡œ **ì‹œê°„ ë³´ì¥** ì…ë‹ˆë‹¤. â°

```javascript
let timerId = setInterval(func|code, [delay], [arg1], [arg2], ...)
```

> setInterval : ì‹œê°„ë§ˆë‹¤ ì£¼ê¸°ì ìœ¼ë¡œ í•´ë‹¹ func ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜.

```javascript
let timerId = setTimeout(func|code, [delay], [arg1], [arg2], ...)
```

> setTimeout : ì¼ì • ì‹œê°„ í›„ì— í•´ë‹¹ func ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜.

ë‹¤ìŒ ê·¸ë¦¼ì„ ë³´ë©´ ì´í•´ê°€ ì‰½ìŠµë‹ˆë‹¤.

![setTimeOut](./setTimeOut.png)

ìœ„ì˜ ê·¸ë¦¼ì²˜ëŸ¼ setIntervalì€ **í•¨ìˆ˜ì˜ ì‹¤í–‰ ì‹œì  ë¶€í„° ì‹œê°„ì„ ì¡ê¸° ë•Œë¬¸** ì— ì‹¤ì œ í•¨ìˆ˜ í˜¸ì¶œì´ ì¢…ë£Œë˜ê³  ë‹¤ìŒ í•¨ìˆ˜ í˜¸ì¶œê¹Œì§€ì˜ ì‹œê°„ì€ ìš°ë¦¬ê°€ ì„¤ì •í•œ ì‹œê°„ë³´ë‹¤ í›¨ì”¬ ì§§ì•„ì§€ê²Œ ë©ë‹ˆë‹¤. ë°˜ë©´ì— setTimeoutì€ í•´ë‹¹ ì‹œê°„ë™ì•ˆ delay í›„ callback í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ìš°ë¦¬ê°€ ì„¤ì •í•œ ì‹œê°„ë§Œí¼ í™•ì‹¤íˆ delayë¥¼ ë³´ì¥í•´ ì¤ë‹ˆë‹¤. ì•„ì£¼ ë‹¹ì—°í•œ ê²°ê³¼ì´ì£ .

ë”°ë¼ì„œ setInterval í•¨ìˆ˜ì—ì„œ ë§Œì•½ callback í•¨ìˆ˜ì˜ ì‹¤í–‰ ì‹œê°„ì´ ìš°ë¦¬ê°€ ì„¤ì •í•´ ë†“ì€ ì‹œê°„ë³´ë‹¤ ê¸¸ì–´ì§€ë©´ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ì§€ ëª»í•˜ëŠ” ë¶ˆí™•ì‹¤ì„±ì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¦‰ setIntervalì€ ì£¼ê¸°ì ìœ¼ë¡œ callbackì„ ì‹¤í–‰ ì‹œí‚¬ ìˆ˜ ìˆìœ¼ë‚˜ ì •í™•í•œ ì‹œê°„ ë³´ì¥ì´ ë˜ì§€ ì•Šê³ , setTimeoutì€ ì£¼ê¸°ì ìœ¼ë¡œ callback í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ì—†ì§€ë§Œ ì‹œê°„ ë³´ì¥ì´ ë©ë‹ˆë‹¤. ğŸ˜‚

ê·¸ëŸ¬ë©´ ë°©ë²•ì´ ì—†ì„ê¹Œìš”? ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. setTimeoutì„ ì¤‘ì²© ì‹œí‚¤ë©´ ë©ë‹ˆë‹¤. ğŸ™Œ

#### ì¤‘ì²© setTimeout

```javascript
let delay = 5000;

let timerId = setTimeout(function request() {
  ...ìš”ì²­ ë³´ë‚´ê¸°...

  if (ì„œë²„ ê³¼ë¶€í•˜ë¡œ ì¸í•œ ìš”ì²­ ì‹¤íŒ¨) {
    // ìš”ì²­ ê°„ê²©ì„ ëŠ˜ë¦½ë‹ˆë‹¤.
    delay *= 2;
  }

  timerId = setTimeout(request, delay);

}, delay);
```

setTimeoutì„ ì¤‘ì²©í•˜ì—¬ ì‚¬ìš©í•œë‹¤ë©´ í™•ì‹¤í•˜ê²Œ ì¼ì •ê¸°ê°„ë§Œí¼ ì‹œê°„ì„ ë³´ì¥ ë°›ì„ ìˆ˜ë„ ìˆê³ , ë“¤ì–´ì˜¤ëŠ” ë°ì´í„°ì˜ ì–‘ì— ë”°ë¼ delayë¥¼ ìˆ˜ì • í•  ìˆ˜ë„ ìˆê² ë‹¤..! ì´ ë°©ë²•ì´ ê°€ì¥ ê¹”ë”í•˜ê² ì–´! ğŸ˜½ ë¼ëŠ” ê¸°ì¨ì´ ë“¤ë©° ì½”ë“œë¥¼ ì‘ì„±í–ˆëŠ”ë° ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

### í´ë¡œì €?

```javascript
// í´ë¡œì ¸ ì‹¤í–‰ ì˜ˆì‹œ. useEffect ì•ˆì—ì„œ numberë¥¼ consoleë¡œ ì°ì–´ë³´ë©´ í•­ìƒ 0ì´ë‹¤.
// useEffect ë°–ì—ì„œ ì½˜ì†”ì„ ì°ì–´ë³´ë©´ ì •ìƒ ë™ì‘í•œë‹¤.
import { useState, useEffect } from "react"

export default function App() {
  const [number, setNumber] = useState(0)

  console.log("numberOuter", number) // 1ì´ˆë§ˆë‹¤ 1ì”© ì¦ê°€.
  useEffect(() => {
    const loop = setInterval(() => {
      setNumber(prev => prev + 1)
      console.log("numberInner", number) // í•­ìƒ 0.

      if (number === 10) clearInterval(loop)
    }, 1000)
  }, [])

  return <div className="App">number : {number}</div>
}
```

ìœ„ì™€ ê°™ì€ ì½”ë“œë¥¼ ë‹¨í¸ì ìœ¼ë¡œ ë³´ë©´ ì–´ë–¨ê¹Œìš”? í•„ìëŠ” setStateëŠ” ë¹„ë™ê¸°ì´ê¸° ë•Œë¬¸ì— number ê°’ì´ ì¦‰ì‹œ ë³€í™˜ë˜ì§€ ì•Šì§€ë§Œ, ì–¸ì  ê°€ 10ì´ ë˜ë©´ setIntervalì´ ë©ˆì¶”ê² ì§€ë¼ê³  ìƒê°í–ˆì—ˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì™¸ë¶€ì—ì„œ ì„ ì–¸ëœ ë³€ìˆ˜ë¥¼ setInterval, setTimeOut í•¨ìˆ˜ ë‚´ì—ì„œ ì‚¬ìš©í–ˆì„ ë•Œ, ê°’ì´ ë³€ê²½ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

numberOuter ì½˜ì†”ì€ 1ì´ˆë§ˆë‹¤ ê³„ì† 1ì”© ì¦ê°€í–ˆëŠ”ë°, numberInnerëŠ” 0ìœ¼ë¡œ ê°’ì´ ê³ ì •ë˜ì–´ setIntervalì´ ë©ˆì¶”ì§€ ì•Šì•˜ì£ ,,

ì´ ë¬¸ì œì— ëŒ€í•´ ê³„ì† ì°¾ì•„ë³´ê²Œ ë˜ì—ˆê³  ì´ê²Œ **Closure** ë¼ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆìŠµë‹ˆë‹¤.

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì‹¤í–‰ì»¨íƒìŠ¤íŠ¸ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

ì´ ì‹¤í–‰ì»¨íƒìŠ¤íŠ¸ì—ëŠ” ë ‰ì‹œì»¬ í™˜ê²½(LexicalEnvironment) ì´ êµ¬ì„±ë˜ì–´ ìˆëŠ”ë° í•¨ìˆ˜ì—ì„œ íŠ¹ì • ë³€ìˆ˜ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

(LexicalEnvironmentì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ [ì—¬ê¸°](https://sonicce99.github.io/execution-context/)ë¥¼ ì°¸ì¡°í•´ì£¼ì„¸ìš”)

ë”°ë¼ì„œ setTimeout ì™¸ë¶€ì—ì„œ ì„ ì–¸í•œ ë³€ìˆ˜ë¥¼ ê°€ì§€ê³  setTimeout ì•ˆì—ì„œ ì‹¤í–‰ì‹œí‚¨ë‹¤ë©´ setTimeoutì€ ì¢…ë£Œë˜ì—ˆì§€ë§Œ outerEnvironmentReferenceì˜ ìŠ¤ì½”í”„ì²´ì¸ìœ¼ë¡œ ì¸í•´ ê³¼ê±°ì˜ ê°’ì„ ë¨¼ì € ì°¸ì¡°í•˜ê²Œ ë©ë‹ˆë‹¤.

### useRefë¥¼ í™œìš©í•´ ë¬¸ì œ í•´ê²°í•˜ê¸°

```javascript
import { useState, useEffect, useRef } from "react"

function useInterval(callback, delay) {
  const savedCallback = useRef()

  useEffect(() => {
    savedCallback.current = callback
  }, [callback])

  useEffect(() => {
    function tick() {
      savedCallback.current()
    }
    if (delay !== null) {
      let id = setInterval(tick, delay)
      return () => clearInterval(id)
    }
  }, [delay])
}
```

Closureì— ì˜í•´ ìƒˆë¡­ê²Œ ë Œë”ë§ëœ ê°’ì— ì ‘ê·¼ í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ Reactì—ì„œëŠ” useRefë¥¼ í†µí•´ ë¦¬ë Œë”ë§ì„ ì¼ìœ¼í‚¤ì§€ ì•Šê³  ìƒˆë¡œìš´ ê°’ì„ ì¦‰ì‹œ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

useEffectë¥¼ í†µí•´ callbackí•¨ìˆ˜ê°€ updateë  ê²½ìš° í•´ë‹¹ ê°’ì„ currentë¡œ ìœ ì§€ì‹œí‚¤ê³  ì•„ë˜ useEffectì—ì„œ current ê°’ì— ì ‘ê·¼ í•¨ìœ¼ë¡œì„œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì´ëŒì–´ ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ê²°ë¡ .

ì. ë‹¤ì‹œ ì²˜ìŒìœ¼ë¡œ ëŒì•„ì™€ì„œ ìš°ë¦¬ì˜ ëª©ì ì€ ì„œë²„ì— `batchNumber` ë¥¼ ê°€ì§€ê³  ë°ì´í„°ê°€ ëª¨ë‘ ì²˜ë¦¬ ë˜ì—ˆëŠ”ì§€ ì§€ì†ì ìœ¼ë¡œ ì§ˆì˜í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.

#### step1. ìš°ì„  polling í•¨ìˆ˜ë¥¼ ë§Œë“¤ì.

```javascript
const longPolling = async () => {
  await waitTime(delay) // íŠ¹ì • ì‹œê°„ë§Œí¼ ê¸°ë‹¤ë¦¼.

  dispatch(Api(batchNumber)) // batchNumberë¥¼ ê°€ì§€ê³  ì„œë²„ì— ì§ˆì˜.
}
```

ì§ˆì˜ë¥¼ í•œë²ˆë§Œ í•˜ë©´ ì•ˆë˜ë‹ˆ ì„œë²„ì—ì„œ responseê°€ ì˜¬ ë•Œê¹Œì§€ `ì§€ì†ì ìœ¼ë¡œ` ì§ˆì˜ í•´ì•¼ê² ì£ ? ê·¸ë˜ì„œ ì¬ê·€í•¨ìˆ˜ë¥¼ í†µí•´ longPolling í•¨ìˆ˜ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œì¤ë‹ˆë‹¤.

#### step2. ë°˜ë³µì ìœ¼ë¡œ ì§ˆì˜í•˜ì.

```javascript
const longPolling = async (delay: number) => {
  await waitTime(delay) // íŠ¹ì • ì‹œê°„ë§Œí¼ ê¸°ë‹¤ë¦¼.

  dispatch(Api(batchNumber)) // batchNumberë¥¼ ê°€ì§€ê³  ì„œë²„ì— ì§ˆì˜.

  longPolling(delay) // ì„œë²„ì— ì§ˆì˜ í›„ ë‹¤ì‹œ í•¨ìˆ˜ ì‹¤í–‰.
}
```

ğŸŒŸ ì¬ê·€í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆìœ¼ë©´ ë°˜ë“œì‹œ íƒˆì¶œ ì¡°ê±´ì„ ëª…ì‹œí•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. ì„œë²„ì— ì‘ë‹µì„ ë°›ì•„ì˜¤ë©´ longPolling í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šê³  return í•  ìˆ˜ ìˆë„ë¡ í•´ì¤˜ì•¼ê² ì£ ? ì–´ë–»ê²Œ í•  ìˆ˜ ìˆì„ê¹Œìš”?

```javascript
// Api ì‹¤í–‰ í›„ ì„œë²„ì—ì„œ ë°›ì•„ì˜¤ëŠ” response
// Api ì‹¤í–‰ê²°ê³¼ë¡œ ë‹¤ìŒ 3ê°€ì§€ê°€ ë‚´ë ¤ì˜µë‹ˆë‹¤. batchNumber, successList(wmsë¡œ ì „ì†¡ ì„±ê³µí•œ ë°ì´í„°), failList(ì „ì†¡ ì‹¤íŒ¨í•œ ë°ì´í„°).
const serverResponse = useAppSelector(state => state.store.serverResponse)

const longPolling = async (delay: number) => {
  await waitTime(delay) // íŠ¹ì • ì‹œê°„ë§Œí¼ ê¸°ë‹¤ë¦¼.

  if (serverResponse?.batchNumber) {
    return
  } else {
    dispatch(Api(batchNumber)) // batchNumberë¥¼ ê°€ì§€ê³  ì„œë²„ì— ì§ˆì˜.

    longPolling(delay) // ì„œë²„ì— ì§ˆì˜ í›„ ë‹¤ì‹œ í•¨ìˆ˜ ì‹¤í–‰.
  }
}
```

âŒ ì ìœ„ì— ì²˜ëŸ¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ê³¼ì—° ì œëŒ€ë¡œ ë™ì‘í• ê¹Œìš”? ì•„ë‹™ë‹ˆë‹¤. ì‘ë‹µì´ ì™”ì„ ê²½ìš° serverResponseëŠ” ìµœì‹ ì˜ ê°’ì„ ê°€ì§€ê³  ìˆì§€ë§Œ, **longPolling í•¨ìˆ˜ ì•ˆì—ì„œì˜ serverResponseëŠ” ìµœì‹ í™”ëœ ê°’ì„ ì°¸ì¡°í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‘ë‹µì´ ì™”ìŒì—ë„ ë¶ˆêµ¬í•˜ê³  íƒˆì¶œí•˜ì§€ ëª»í•˜ê³  dispatchë¥¼ ê³„ì†í•˜ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ í•¨ìˆ˜ë¥¼ íƒˆì¶œí•˜ê¸° ìœ„í•´ useRefë¥¼ ì‚¬ìš©í•´ì•¼í•©ë‹ˆë‹¤.**

#### useRef ì‚¬ìš©.

```javascript
const serverResponse = useAppSelector(state => state.store.serverResponse)
const serverResponse_ref = useRef(null)

useEffect(() => {
  if (serverResponse?.batchNumber) {
    serverResponse_ref.current = serverResponse
  }
}, [serverResponse])

const longPolling = async (delay: number) => {
  await waitTime(delay) // íŠ¹ì • ì‹œê°„ë§Œí¼ ê¸°ë‹¤ë¦¼.

  if (serverResponse_ref.currnet?.batchNumber) {
    serverResponse_ref.current = null
    return
  } else {
    dispatch(Api(batchNumber)) // batchNumberë¥¼ ê°€ì§€ê³  ì„œë²„ì— ì§ˆì˜.

    longPolling(delay) // ì„œë²„ì— ì§ˆì˜ í›„ ë‹¤ì‹œ í•¨ìˆ˜ ì‹¤í–‰.
  }
}
```

### ë¶€ë¡. (ìº¡ìŠí™”, ì€ë‹‰í™”)

í´ë¡œì €ëŠ” ì •ë³´ ì€ë‹‰ê³¼ ê´€ê³„ê°€ ë§¤ìš° ê¹ŠìŠµë‹ˆë‹¤.

javascriptëŠ” Prototype ê¸°ë°˜ OOPë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ì´ëŸ¬í•œ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì—ì„œ ì™¸ë¶€ ì‚¬ìš©ìì—ê²Œ ë…¸ì¶œì´ ë¶ˆí•„ìš”í•œ ì†ì„±, í–‰ìœ„ë¥¼ ë…¸ì¶œí•˜ëŠ” ê²ƒì€ ë§¤ìš° ì¢‹ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë‚˜ìœ ì˜ë„ë¥¼ ê°€ì§„ ì‚¬ìš©ìê°€ ì •ë³´ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì•„ë˜ëŠ” ê°„ë‹¨í•œ counter í´ë¡œì €ì…ë‹ˆë‹¤.

```javascript
const counter = (() => {
  let privateCounter = 0

  return {
    value: () => privateCounter,
    increment: () => privateCounter++,
    decreasement: () => privateCounter--,
  }
})()

console.log(counter.value()) // 0
counter.increment()
console.log(counter.value()) // 1
counter.decreasement()
console.log(counter.value()) // 0
```

console.logë¥¼ í†µí•´ privateCounterì— ì ‘ê·¼í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ë°©ë²•ì´ ìˆë‚˜ìš”?

ë°©ë²•ì´ ì—†ìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” í´ë¡œì €ë¥¼ ì‚¬ìš©í•˜ì—¬ privateCounterë¥¼ ì€ë‹‰í•  ìˆ˜ ìˆê³  ì‚¬ìš©ìëŠ” privateCounter ë³€ìˆ˜ì˜ ì¡´ì¬ ì—¬ë¶€ì— ëŒ€í•´ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ì¦‰ counterë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ìëŠ” ì² ì €íˆ value, increment, decreasementë¥¼ í†µí•´ privateCounterë¥¼ ì¡°íšŒ, ì¦ê°€, ê°ì†Œ í•˜ëŠ” í–‰ìœ„ë§Œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë§ˆì¹˜ë©°.

polling ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ê³µë¶€ë¥¼ í•˜ë©´ì„œ `ë¹„ë™ê¸° ë°ì´í„° ì²˜ë¦¬ë°©ì‹`ì— ëŒ€í•´ì„œ ë§ì´ ê³µë¶€í•  ìˆ˜ ìˆì—ˆë˜ ê³„ê¸°ê°€ ë˜ì—ˆë‹¤. ë” ì—´ì‹¬íˆ í•´ì„œ ìš°ì•„í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆëŠ”, ë” ì¢‹ì€ ë™ë£Œê°€ ë˜ê¸° ìœ„í•´ ë…¸ë ¥í•´ì•¼ê² ë‹¤. ê·¸ë¦¬ê³  í•­ìƒ ì¢‹ì€ adviceë¥¼ í•´ì£¼ì‹œëŠ” ì¡°ìˆ˜ê´€ ê¸°ìˆ  ì´ì‚¬ë‹˜ê»˜ ê°ì‚¬í•¨ì„ ëŠë‚€ë‹¤. ğŸ™ğŸ»

#### ì°¸ì¡°

ì•„ë˜ëŠ” ì´ ê¸€ì„ ì‘ì„±í•˜ë©° ì°¸ì¡°í•œ ë¸”ë¡œê·¸ì…ë‹ˆë‹¤.

- [Reactì—ì„œ setInterval í˜„ëª…í•˜ê²Œ ì‚¬ìš©í•˜ê¸°(feat. useInterval)](https://mingule.tistory.com/65)
