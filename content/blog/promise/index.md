---
title: "PromiseëŠ” ì–´ë–¤ ê²ƒì´ê³  ì–´ë–»ê²Œ ì‚¬ìš©í•˜ë‚˜ìš”?"
date: "2022-05-14"
description: "ì‹¤ë¬´ì—ì„œ sheet.jsë¥¼ ì‚¬ìš©í•˜ë©° sellerê°€ ì—…ë¡œë“œí•œ ì—‘ì…€ íŒŒì¼ì„ Jsonìœ¼ë¡œ ë°ì´í„°í™” ì‹œì¼œì•¼í–ˆê³  ì œëŒ€ë¡œëœ ë™ì‘ì„ í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ìœ„í•´ Promiseì— ëŒ€í•œ ì •í™•í•œ ì´í•´ì™€ ê³µë¶€ê°€ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ì–´ë–¤ ì´ìœ ì—ì„œ Promiseê°€ í•„ìš”í–ˆê³  ì–´ë–»ê²Œ ë¬¸ì œë¥¼ í•´ê²°í–ˆëŠ”ì§€ì— ê´€í•œ ì´ì•¼ê¸°ì…ë‹ˆë‹¤."
---

## ë“¤ì–´ê°€ë©°

ìš”ì¦ˆìŒ íšŒì‚¬ì—ì„œ OMS(ì£¼ë¬¸ ê´€ë¦¬ ì‹œìŠ¤í…œ)ë¥¼ ê°œë°œí•˜ê³  ìˆë‹¤. OMSëŠ” `Order Management System` ì´ë‹¤. ì´ ì‹œìŠ¤í…œì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì¤‘ í•˜ë‚˜ëŠ” íŒë§¤ì(ìš°ë¦¬í•œí… ê³ ê°)ê°€ ì—…ë¡œë“œí•œ ì—‘ì…€ì„ ì •í™•í•˜ê²Œ ì½ì–´ì™€ì•¼í•œë‹¤ëŠ” ì ì´ë‹¤. ì´ ì—‘ì…€ì„ ì½ì–´ì™€ì•¼ í•˜ëŠ” ë¶€ë¶„ì—ì„œ ë‚´ê°€ ì¤‘ìš”í•˜ê²Œ ìƒê°í–ˆë˜ ì ì€ `SRPë¥¼ ì§€í‚¤ë„ë¡ ì½”ë“œë¥¼ ë¶„ë¦¬í•˜ì` ì´ë‹¤. ì´ ê³ ë¯¼ì˜ ëì— `Promise` ë¥¼ í™œìš©í•´ì•¼ê² ë‹¤ê³  ìƒê°í–ˆìœ¼ë©° ì œëŒ€ë¡œ ê³µë¶€í•˜ê³  ì´ë¥¼ ë‚¨ê²¨ë³´ê³ ì í•œë‹¤.

## ê¸°ì¡´ ì‹œìŠ¤í…œì˜ í•œê³„ì 

ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í–ˆë˜ ì ì€ SRPì´ë‹¤. ê¸°ì¡´ ì‹œìŠ¤í…œì€ ì—…ë¡œë“œ í•¨ìˆ˜ê°€ ì—…ë¡œë“œë§Œ ë‹´ë‹¹í•˜ê³  ìˆì§€ ì•Šì•˜ë‹¤. ì˜¨ê°– stateë¡œ Props drillingì´ ì‹¬í•´ ì–´ë””ì„œ ì˜¨ stateì¸ì§€ ê°€ëŠ í•˜ê¸°ê°€ ì–´ë ¤ì› ìœ¼ë©°, í•˜ë‚˜ì˜ í•¨ìˆ˜ì—ì„œ ì—¬ëŸ¬ stateë¥¼ í™œìš©í•´ ìƒíƒœë¥¼ ë³€ê²½í•˜ì—¬ ìƒíƒœê°€ ì–´ë””ì„œ ì–´ë–»ê²Œ ë‹¬ë¼ì¡ŒëŠ”ì§€ ê°€ëŠ í•˜ê¸°ê°€ ì–´ë ¤ì› ë‹¤.

ğŸ“ **ë”°ë¼ì„œ ìµœëŒ€í•œ excel íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ” ë¶€ë¶„ì„ ëª¨ë“ˆí™” ì‹œì¼œì„œ ë¶„ë¦¬ë¥¼ ì‹œì¼œì•¼ë§Œ í–ˆë‹¤.**

## ì—‘ì…€ì„ ì½ëŠ” ë°©ì‹

ì—‘ì…€ì„ ì½ëŠ” ë°©ì‹ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ê°€ ìˆì§€ë§Œ í˜„ì¬ íšŒì‚¬ ë¡œì§ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì€ 2ê°€ì§€ë‹¤.

- readAsArrayBuffer()

- readAsBinaryString()

íšŒì‚¬ì—ì„œ ì—°ë™ëœ ë§ˆì¼“ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆë‹¤. ë„¤ì´ë²„, ì¿ íŒ¡, ì¸í„°íŒŒí¬ ë“±ë“±...

ê¸°ì¡´ ì‹œìŠ¤í…œì˜ ì½”ë“œ flowë¥¼ ëŒ€ëµì ìœ¼ë¡œ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```javascript
const reader = new FileReader();
 if (fileExt === 'xlsx' || fileExt === 'xls' || fileExt === 'csv') {
    reader.readAsArrayBuffer(file);
    reader.onload = (evt) => {
      // ... ì—‘ì…€ì„ ì½ì–´ì˜¤ëŠ” ë¡œì§ ì¡´ì¬.

      // ì½ì–´ì˜¨ íŒŒì¼ ë°ì´í„°ê°€ ì¡´ì¬í•˜ë©´ íŠ¹ì • ê°’ë“¤ì„ set í•˜ëŠ” ë¡œì§ ì¡´ì¬.
      if(firstSheetName) {
        ... setState(something)
      }

      // ì½ì–´ì˜¨ ë°ì´í„°ê°€ ì—†ë‹¤ë©´ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì½ì–´ì˜¤ë„ë¡ ì‹¤í–‰.
      else {
         reader.readAsBinaryString(file);
            reader.onload = () => {
              // ... ê°™ì€ ë™ì‘ ë°˜ë³µ.
              ... setState(something)
            }
      }
      //
    }
 }
 else {
   ... setState(something)
 }
```

ìœ„ì™€ ê°™ì€ ì½”ë“œëŠ” Clean í•˜ì§€ ì•Šë‹¤ê³  ìƒê°í–ˆìœ¼ë©° í™•ì‹¤í•˜ê²Œ ì—‘ì…€ì„ ì½ì–´ì˜¤ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ì—¬ëŸ¬ ê³³ì—ì„œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì•¼ê² ë‹¤ê³  ìƒê°í–ˆë‹¤.

### ì½”ë“œ ê°œì„  ì¤‘ ë°œìƒí•œ ë¬¸ì œì ?

```javascript
let worksheet = {};
reader.onload = (evt) => {
  worksheet = ì½ì–´ì˜¨ ë°ì´í„°
}

console.log(worksheet);
```

ì½”ë“œë¥¼ ìˆ˜ì •í•˜ë‹¤ê°€ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œì ì´ ë°œìƒí–ˆë‹¤. ìœ„ì™€ ê°™ì´ ì½”ë“œë¥¼ ì§œë©´ í•´ë‹¹ console.log ì—ëŠ” ë¬´ì—‡ì´ ì°íê¹Œ?

1. ì œëŒ€ë¡œ ì½ì–´ì˜¨ worksheet ê°’.

2. ë¹ˆ Object.

ì •ë‹µì€ 2ë²ˆ. ì‹¤í–‰ ê²°ê³¼ worksheetì—ëŠ” ì œëŒ€ë¡œ ê°’ì´ ì±„ì›Œì§€ì§€ ì•Šì•˜ë‹¤. ì™œ ê·¸ëŸ´ê¹Œ?

_reader.onload() í•¨ìˆ˜ëŠ” `ë¹„ë™ê¸° í•¨ìˆ˜` ì´ê¸° ë•Œë¬¸ì´ë‹¤._

ë¹„ë™ê¸°ì´ê¸° ë•Œë¬¸ì— ì œëŒ€ë¡œ ëœ ê°’ì„ ì½ì–´ì˜¤ê¸° ì „ì— ê¸°ì¡´ì˜ ë¹ˆ ê°’ì´ ì°í˜€ë²„ë¦¬ëŠ” ê²ƒì´ë‹¤.

### ê·¸ë˜ì„œ ì–´ë–»ê²Œ í•´ì•¼í•´?

ê²°êµ­ í•´ë‹¹ ì½˜ì†”ì€ ì œëŒ€ë¡œ worksheetê°€ ì£¼ì…ë˜ë©´ ë™ì‘ë˜ë„ë¡ ë§Œë“¤ì–´ì•¼ í–ˆê³  ê³ ì‹¬ ëì— promiseë¥¼ í™œìš©í•˜ê¸°ë¡œ í–ˆë‹¤. **promiseë¥¼ í†µí•´ worksheetë¥¼ ì½ì–´ì˜¨ ê²ƒì´ ì œëŒ€ë¡œ resolve ë˜ë©´ ë™ì‘ì„ í•˜ë„ë¡ í•˜ë©´ ë˜ê² ë‹¤** ë¼ëŠ” ìƒê°ì„ í–ˆê¸° ë•Œë¬¸ì´ë‹¤.

---

## Promiseê°€ ë­ì§€?

- `promise`ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ë²•ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
let promise = new Promise(function (resolve, reject) {
  // executor.
})
```

new Promiseì— ì „ë‹¬ë˜ëŠ” í•¨ìˆ˜ëŠ” executor(ì‹¤í–‰ì, ì‹¤í–‰ í•¨ìˆ˜) ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. executorëŠ” new Promiseê°€ ë§Œë“¤ì–´ì§ˆ ë•Œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

executorì˜ ì¸ìˆ˜ resolveì™€ rejectëŠ” `ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì´ ë¯¸ë¦¬ ì •ì˜í•œ ìì²´ ì œê³µí•˜ëŠ” ì½œë°±`ì…ë‹ˆë‹¤. ê°œë°œìëŠ” resolveì™€ rejectë¥¼ ì‹ ê²½ ì“°ì§€ ì•Šê³  executor ì•ˆ ì½”ë“œë§Œ ì‘ì„±í•˜ë©´ ë©ë‹ˆë‹¤.

ëŒ€ì‹  executorì—ì„  ê²°ê³¼ë¥¼ ì¦‰ì‹œ ì–»ë“  ëŠ¦ê²Œ ì–»ë“  ìƒê´€ì—†ì´ ìƒí™©ì— ë”°ë¼ ì¸ìˆ˜ë¡œ ë„˜ê²¨ì¤€ ì½œë°± ì¤‘ í•˜ë‚˜ë¥¼ ë°˜ë“œì‹œ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.

- resolve(value) : ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ëë‚œ ê²½ìš° ê·¸ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” valueì™€ í•¨ê»˜ í˜¸ì¶œ

- reject(error) â€” ì—ëŸ¬ ë°œìƒ ì‹œ ì—ëŸ¬ ê°ì²´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” errorì™€ í•¨ê»˜ í˜¸ì¶œ

new Promise ìƒì„±ìê°€ ë°˜í™˜í•˜ëŠ” promise ê°ì²´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‚´ë¶€ í”„ë¡œí¼í‹°ë¥¼ ê°–ìŠµë‹ˆë‹¤.

- `state` : ì²˜ìŒì—” `pending(ë³´ë¥˜)`ì´ì—ˆë‹¤ resolveê°€ í˜¸ì¶œë˜ë©´ `fulfilled`, rejectê°€ í˜¸ì¶œë˜ë©´ `rejected` ë¡œ ë³€í•©ë‹ˆë‹¤.

- `result` : ì²˜ìŒì—” `undefined`ì´ì—ˆë‹¤ resolve(value)ê°€ í˜¸ì¶œë˜ë©´ valueë¡œ, reject(error)ê°€ í˜¸ì¶œë˜ë©´ errorë¡œ ë³€í•©ë‹ˆë‹¤.

![promiseState](./promiseState.png)

â—ï¸ ì²˜ë¦¬ê°€ ëë‚œ í”„ë¼ë¯¸ìŠ¤ì— resolveì™€ rejectë¥¼ í˜¸ì¶œí•˜ë©´ ë¬´ì‹œë©ë‹ˆë‹¤.

```javascript
let promise = new Promise(function (resolve, reject) {
  resolve("ì™„ë£Œ")

  reject(new Error("â€¦")) // ë¬´ì‹œë¨
  setTimeout(() => resolve("â€¦")) // ë¬´ì‹œë¨
})
```

â—ï¸ ì—¬ê¸°ì— ë”í•˜ì—¬ resolveë‚˜ rejectëŠ” **ì¸ìˆ˜ë¥¼ í•˜ë‚˜ë§Œ** ë°›ê³ (í˜¹ì€ ì•„ë¬´ê²ƒë„ ë°›ì§€ ì•ŠìŒ) `ê·¸ ì´ì™¸ì˜ ì¸ìˆ˜ëŠ” ë¬´ì‹œ`í•œë‹¤ëŠ” íŠ¹ì„±ë„ ìˆìŠµë‹ˆë‹¤.

### Promise.then((result, error))

thenì€ 2ê°€ì§€ì˜ ì¸ìˆ˜ë¥¼ ë°›ìŠµë‹ˆë‹¤. ë§Œì•½ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ëœ ê²½ìš°ë§Œ ë‹¤ë£¨ê³  ì‹¶ë‹¤ë©´, thenì— ì¸ìˆ˜ë¥¼ í•˜ë‚˜ë§Œ ì „ë‹¬í•˜ë©´ ë©ë‹ˆë‹¤.

```javascript
promise.then(
  function (result) {
    // resolve ì‹œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜.
  },

  function (error) {
    // reject ì‹œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜.
  }
)
```

```javascript
let promise = new Promise(function (resolve, reject) {
  setTimeout(() => resolve("ì™„ë£Œ!"), 1000)
})

// resolve í•¨ìˆ˜ëŠ” .thenì˜ ì²« ë²ˆì§¸ í•¨ìˆ˜(ì¸ìˆ˜)ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
promise.then(
  result => alert(result), // 1ì´ˆ í›„ "ì™„ë£Œ!"ë¥¼ ì¶œë ¥
  error => alert(error) // ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
)
```

### Catch()

.then(result,error) {} ë¥¼ ì‚¬ìš©í•´ë„ ë˜ê³ ,
.then(value).catch() ë¥¼ ì‚¬ìš©í•´ë„ ë˜ê³ ,

ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš°ë§Œ ë‹¤ë£¨ê³  ì‹¶ë‹¤ë©´ .then(null, fnc())ì„ ì‚¬ìš©í•˜ê±°ë‚˜.
.then(null).catchë¥¼ ì‚¬ìš©í•´ë„ ë©ë‹ˆë‹¤.

.catch(f)ëŠ” ë¬¸ë²•ì´ ê°„ê²°í•˜ë‹¤ëŠ” ì ë§Œ ë¹¼ê³  .then(null,f)ê³¼ ì™„ë²½í•˜ê²Œ ê°™ìŠµë‹ˆë‹¤.

---

### Promiseì™€ Error handling

Promiseê°€ ê±°ë¶€ë˜ë©´ ì œì–´ íë¦„ì´ ê°€ì¥ ê°€ê¹Œìš´ rejection í•¸ë“¤ëŸ¬ë¡œ ë„˜ì–´ê°€ê¸° ë•Œë¬¸ì— í”„ë¼ë¯¸ìŠ¤ ì²´ì¸ì„ ì‚¬ìš©í•˜ë©´ ì—ëŸ¬ë¥¼ ì‰½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì²´ì¸ ë§ˆì§€ë§‰ì˜ .catchëŠ” try..catchì™€ ìœ ì‚¬í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. .then í•¸ë“¤ëŸ¬ë¥¼ ì›í•˜ëŠ” ë§Œí¼ ì‚¬ìš©í•˜ë‹¤ ë§ˆì§€ë§‰ì— .catch í•˜ë‚˜ë§Œ ë¶™ì´ë©´ .then í•¸ë“¤ëŸ¬ì—ì„œ ë°œìƒí•œ ëª¨ë“  ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
fetch("/article/promise-chaining/user.json") // ì¡´ì¬í•˜ì§€ ì•ŠëŠ” urlì´ê¸° ë•Œë¬¸ì— ë¬´ì¡°ê±´ ê±°ë¶€ë¨.
  .then(response => response.json()) // ë¬´ì‹œë¨
  .then(user => fetch(`https://api.github.com/users/${user.name}`)) // ë¬´ì‹œë¨
  .then(response => response.json()) // ë¬´ì‹œë¨
  .then(
    githubUser =>
      new Promise((resolve, reject) => {
        // ë¬´ì‹œë¨
        let img = document.createElement("img")
        img.src = githubUser.avatar_url
        img.className = "promise-avatar-example"
        document.body.append(img)

        setTimeout(() => {
          img.remove()
          resolve(githubUser)
        }, 3000)
      })
  )
  .catch(error => alert(error.message)) // ì‹¤í–‰.
```

executor ì£¼ìœ„ì˜ 'ì•”ì‹œì  try..catch'ëŠ” ìŠ¤ìŠ¤ë¡œ ì—ëŸ¬ë¥¼ ì¡ê³ , ì—ëŸ¬ë¥¼ ê±°ë¶€ìƒíƒœì˜ í”„ë¼ë¯¸ìŠ¤ë¡œ ë³€ê²½ì‹œí‚µë‹ˆë‹¤.

ì´ëŸ° ì¼ì€ executor í•¨ìˆ˜ë¿ë§Œ ì•„ë‹ˆë¼ í•¸ë“¤ëŸ¬ì—ì„œë„ ë°œìƒí•©ë‹ˆë‹¤. .then í•¸ë“¤ëŸ¬ ì•ˆì—ì„œ throwë¥¼ ì‚¬ìš©í•´ ì—ëŸ¬ë¥¼ ë˜ì§€ë©´, ì´ ìì²´ê°€ ê±°ë¶€ëœ í”„ë¼ë¯¸ìŠ¤ë¥¼ ì˜ë¯¸í•˜ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì œì–´ íë¦„ì´ ê°€ì¥ ê°€ê¹Œìš´ ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.

ë§ˆì§€ë§‰ `.catch`ëŠ” ì´ë ‡ê²Œ ëª…ì‹œì ì¸ ê±°ë¶€ë¿ë§Œ ì•„ë‹ˆë¼ í•¸ë“¤ëŸ¬ ìœ„ìª½ì—ì„œ ë°œìƒí•œ ë¹„ì •ìƒ ì—ëŸ¬ ë˜í•œ ì¡ìŠµë‹ˆë‹¤.

```javascript
new Promise((resolve, reject) => {
  resolve("OK")
})
  .then(result => {
    blabla() // ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜
  })
  .catch(alert) // ReferenceError: blabla is not defined
```

### ë‹¤ì‹œ ë˜ì§€ê¸°

ì¼ë°˜ try..catchì—ì„  ì—ëŸ¬ë¥¼ ë¶„ì„í•˜ê³ , ì²˜ë¦¬í•  ìˆ˜ ì—†ëŠ” ì—ëŸ¬ë¼ íŒë‹¨ë˜ë©´ ì—ëŸ¬ë¥¼ ë‹¤ì‹œ ë˜ì§ˆ ë•Œê°€ ìˆìŠµë‹ˆë‹¤. í”„ë¼ë¯¸ìŠ¤ì—ë„ ìœ ì‚¬í•œ ì¼ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

.catch ì•ˆì—ì„œ throwë¥¼ ì‚¬ìš©í•˜ë©´ ì œì–´ íë¦„ì´ ê°€ì¥ ê°€ê¹Œìš´ ê³³ì— ìˆëŠ” ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì—ëŸ¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ë©´ **ê°€ì¥ ê°€ê¹Œìš´ ê³³ì— ìˆëŠ” .then í•¸ë“¤ëŸ¬ë¡œ ì œì–´ íë¦„ì´ ë„˜ì–´ê°€ ì‹¤í–‰ì´ ì´ì–´ì§‘ë‹ˆë‹¤.**

```javascript
// ì‹¤í–‰ ìˆœì„œ: catch -> then
new Promise((resolve, reject) => {
  throw new Error("ì—ëŸ¬ ë°œìƒ!")
})
  .catch(function (error) {
    alert("ì—ëŸ¬ê°€ ì˜ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ì´ ì´ì–´ì§‘ë‹ˆë‹¤.")
  })
  .then(() => alert("ë‹¤ìŒ í•¸ë“¤ëŸ¬ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤."))
```

.catch ë¸”ë¡ì´ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ì—ˆê¸° ë•Œë¬¸ì— ë‹¤ìŒ ì„±ê³µ í•¸ë“¤ëŸ¬ .thenì´ í˜¸ì¶œëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì²˜ë¦¬ë˜ì§€ ëª»í•œ ê±°ë¶€

ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ í”„ë¼ë¯¸ìŠ¤ëŠ” ê±°ë¶€ìƒíƒœê°€ ë˜ê³ , ì‹¤í–‰ íë¦„ì€ ê°€ì¥ ê°€ê¹Œìš´ rejection í•¸ë“¤ëŸ¬ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤. ê·¸ëŸ°ë° ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•´ì¤„ í•¸ë“¤ëŸ¬ê°€ ì—†ë‹¤ë©´?

ë”ì°í•œ ì¼ì´ ë°œìƒí•©ë‹ˆë‹¤. ğŸ¥²

ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ í”„ë¼ë¯¸ìŠ¤ ê±°ë¶€ë¥¼ ì¶”ì í•˜ë‹¤ê°€ ìœ„ì™€ ê°™ì€ ìƒí™©ì´ ë°œìƒí•˜ë©´ `ì „ì—­ ì—ëŸ¬`ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì½˜ì†”ì°½ì„ ì—´ê³  ìœ„ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•˜ë©´ ì „ì—­ ì—ëŸ¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„  ì´ëŸ° ì—ëŸ¬ë¥¼ `unhandledrejection ì´ë²¤íŠ¸`ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
window.addEventListener("unhandledrejection", function (event) {
  // unhandledrejection ì´ë²¤íŠ¸ì—” ë‘ ê°œì˜ íŠ¹ìˆ˜ í”„ë¡œí¼í‹°ê°€ ìˆìŠµë‹ˆë‹¤.
  alert(event.promise) // [object Promise] - ì—ëŸ¬ë¥¼ ìƒì„±í•˜ëŠ” í”„ë¼ë¯¸ìŠ¤
  alert(event.reason) // Error: ì—ëŸ¬ ë°œìƒ! - ì²˜ë¦¬í•˜ì§€ ëª»í•œ ì—ëŸ¬ ê°ì²´
})

new Promise(function () {
  throw new Error("ì—ëŸ¬ ë°œìƒ!")
}) // ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” .catch í•¸ë“¤ëŸ¬ê°€ ì—†ìŒ
```

---

## Promise Api

Promise í´ë˜ìŠ¤ì—ëŠ” 5ê°€ì§€ ì •ì  ë©”ì„œë“œê°€ ìˆìŠµë‹ˆë‹¤.

1. Promise.all

> ì—¬ëŸ¬ê°œì˜ Promiseë¥¼ ë™ì‹œì— ì‹¤í–‰ ì‹œí‚¤ê³  ëª¨ë“  promiseê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•  ë•Œ ì‚¬ìš©.

2. Promise.allSettled

> ëª¨ë“  í”„ë¼ë¯¸ìŠ¤ê°€ ì²˜ë¦¬ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤. promise.allì€ promiseê°€ í•˜ë‚˜ë¼ë„ ê±°ì ˆë˜ë©´ ì „ì²´ë¥¼ ê±°ì ˆí•˜ì§€ë§Œ promise.allSettledëŠ” ì—¬ëŸ¬ ìš”ì²­ ì¤‘ í•˜ë‚˜ê°€ ì‹¤íŒ¨í•˜ë„ ë™ì‘í•©ë‹ˆë‹¤.

3. Promise.race

> Promise.allê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤. ë‹¤ë§Œ ê°€ì¥ ë¨¼ì € ì²˜ë¦¬ë˜ëŠ” í”„ë¼ë¯¸ìŠ¤ì˜ ê²°ê³¼(í˜¹ì€ ì—ëŸ¬)ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

4. Promise.resolve

5. Promise.reject

- í”„ë¼ë¯¸ìŠ¤ ë©”ì„œë“œ Promise.resolveì™€ Promise.rejectëŠ” async/await ë¬¸ë²•(ë’¤ì—ì„œ ë‹¤ë£¸)ì´ ìƒê¸´ í›„ë¡œ ì“¸ëª¨ì—†ì–´ì¡Œê¸° ë•Œë¬¸ì— ê·¼ë˜ì—ëŠ” ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### Promise.all ?

ì—¬ëŸ¬ ê°œì˜ í”„ë¼ë¯¸ìŠ¤ë¥¼ ë™ì‹œì— ì‹¤í–‰ì‹œí‚¤ê³  ëª¨ë“  í”„ë¼ë¯¸ìŠ¤ê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤ê³  í•´ë´…ì‹œë‹¤.

```javascript
let promise = Promise.all([...promises...]);
```

Promise.allì€ ìš”ì†Œ ì „ì²´ê°€ í”„ë¼ë¯¸ìŠ¤ì¸ ë°°ì—´(ì—„ë°€íˆ ë”°ì§€ë©´ ì´í„°ëŸ¬ë¸” ê°ì²´ì´ì§€ë§Œ, ëŒ€ê°œëŠ” ë°°ì—´ì„)ì„ ë°›ê³  ìƒˆë¡œìš´ í”„ë¼ë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

ë°°ì—´ ì•ˆ í”„ë¼ë¯¸ìŠ¤ê°€ ëª¨ë‘ ì²˜ë¦¬ë˜ë©´ ìƒˆë¡œìš´ í”„ë¼ë¯¸ìŠ¤ê°€ ì´í–‰ë˜ëŠ”ë°, ë°°ì—´ ì•ˆ í”„ë¼ë¯¸ìŠ¤ì˜ ê²°ê´ê°’ì„ ë‹´ì€ ë°°ì—´ì´ ìƒˆë¡œìš´ í”„ë¼ë¯¸ìŠ¤ì˜ resultê°€ ë©ë‹ˆë‹¤.

```javascript
Promise.all([
  new Promise(resolve => setTimeout(() => resolve(1), 3000)), // 1
  new Promise(resolve => setTimeout(() => resolve(2), 2000)), // 2
  new Promise(resolve => setTimeout(() => resolve(3), 1000)), // 3
]).then(alert) // í”„ë¼ë¯¸ìŠ¤ ì „ì²´ê°€ ì²˜ë¦¬ë˜ë©´ 1, 2, 3ì´ ë°˜í™˜ë©ë‹ˆë‹¤. ê° í”„ë¼ë¯¸ìŠ¤ëŠ” ë°°ì—´ì„ êµ¬ì„±í•˜ëŠ” ìš”ì†Œê°€ ë©ë‹ˆë‹¤.
```

ğŸŒŸ ë°°ì—´ resultì˜ ìš”ì†Œ ìˆœì„œëŠ” Promise.allì— ì „ë‹¬ë˜ëŠ” í”„ë¼ë¯¸ìŠ¤ ìˆœì„œì™€ ìƒì‘í•œë‹¤ëŠ” ì ì— ì£¼ëª©í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤. Promise.allì˜ ì²« ë²ˆì§¸ í”„ë¼ë¯¸ìŠ¤ëŠ” _ê°€ì¥ ëŠ¦ê²Œ ì´í–‰ë˜ë”ë¼ë„ ì²˜ë¦¬ ê²°ê³¼ëŠ” ë°°ì—´ì˜ ì²« ë²ˆì§¸ ìš”ì†Œì— ì €ì¥_ ë©ë‹ˆë‹¤.

â—ï¸ Promise.allì— ì „ë‹¬ë˜ëŠ” í”„ë¼ë¯¸ìŠ¤ ì¤‘ `í•˜ë‚˜ë¼ë„ ê±°ë¶€ë˜ë©´`, Promise.allì´ ë°˜í™˜í•˜ëŠ” í”„ë¼ë¯¸ìŠ¤ëŠ” ì—ëŸ¬ì™€ í•¨ê»˜ ë°”ë¡œ ê±°ë¶€ë©ë‹ˆë‹¤.

```javascript
Promise.all([
  new Promise((resolve, reject) => setTimeout(() => resolve(1), 1000)),
  new Promise((resolve, reject) =>
    setTimeout(() => reject(new Error("ì—ëŸ¬ ë°œìƒ!")), 2000)
  ),
  new Promise((resolve, reject) => setTimeout(() => resolve(3), 3000)),
]).catch(alert) // Error: ì—ëŸ¬ ë°œìƒ!
```

ğŸ“ ì´í„°ëŸ¬ë¸” ê°ì²´ê°€ ì•„ë‹Œ `ì¼ë°˜ê°’` ë„ Promise.all(iterable)ì— ë„˜ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
Promise.all([
  new Promise((resolve, reject) => {
    setTimeout(() => resolve(1), 1000)
  }),
  2,
  3,
]).then(alert) // 1, 2, 3
```

### Promise.allSettled

â—ï¸ ìŠ¤í™ì— ì¶”ê°€ëœ ì§€ ì–¼ë§ˆ ì•ˆ ëœ ë¬¸ë²•ì…ë‹ˆë‹¤. êµ¬ì‹ ë¸Œë¼ìš°ì €ëŠ” `í´ë¦¬í•„`ì´ í•„ìš”í•©ë‹ˆë‹¤.

fetchë¥¼ ì‚¬ìš©í•´ ì—¬ëŸ¬ ì‚¬ëŒì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆë‹¤ê³  í•´ë´…ì‹œë‹¤. ì—¬ëŸ¬ ìš”ì²­ ì¤‘ í•˜ë‚˜ê°€ ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ ìš”ì²­ ê²°ê³¼ëŠ” ì—¬ì „íˆ í•„ìš”í•©ë‹ˆë‹¤.

```javascript
let urls = [
  "https://api.github.com/users/iliakan",
  "https://api.github.com/users/Violet-Bora-Lee",
  "https://no-such-url",
]

Promise.allSettled(urls.map(url => fetch(url))).then(results => {
  // (*)
  results.forEach((result, num) => {
    if (result.status == "fulfilled") {
      alert(`${urls[num]}: ${result.value.status}`)
    }
    if (result.status == "rejected") {
      alert(`${urls[num]}: ${result.reason}`)
    }
  })
})
```

(\*)ë¡œ í‘œì‹œí•œ ì¤„ì˜ resultsëŠ” ë‹¤ìŒê³¼ ê°™ì„ ê²ë‹ˆë‹¤.

```javascript
[
  {status: 'fulfilled', value: ...ì‘ë‹µ...},
  {status: 'fulfilled', value: ...ì‘ë‹µ...},
  {status: 'rejected', reason: ...ì—ëŸ¬ ê°ì²´...}
]
```

ğŸŒŸ Promise.allSettledë¥¼ ì‚¬ìš©í•˜ë©´ ì´ì²˜ëŸ¼ `ê° í”„ë¼ë¯¸ìŠ¤ì˜ ìƒíƒœì™€ ê°’ ë˜ëŠ” ì—ëŸ¬ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`

### Promise.race

Promise.raceëŠ” Promise.allê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤. _ë‹¤ë§Œ ê°€ì¥ ë¨¼ì € ì²˜ë¦¬ë˜ëŠ” í”„ë¼ë¯¸ìŠ¤ì˜ ê²°ê³¼(í˜¹ì€ ì—ëŸ¬)ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤._

```javascript
Promise.race([
  new Promise((resolve, reject) => setTimeout(() => resolve(1), 1000)),
  new Promise((resolve, reject) =>
    setTimeout(() => reject(new Error("ì—ëŸ¬ ë°œìƒ!")), 2000)
  ),
  new Promise((resolve, reject) => setTimeout(() => resolve(3), 3000)),
]).then(alert) // 1
```

---

## async await

function ì•ì— asyncë¥¼ ë¶™ì´ë©´ í•´ë‹¹ í•¨ìˆ˜ëŠ” í•­ìƒ í”„ë¼ë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. í”„ë¼ë¯¸ìŠ¤ê°€ ì•„ë‹Œ ê°’ì„ ë°˜í™˜í•˜ë”ë¼ë„ ì´í–‰ ìƒíƒœì˜ í”„ë¼ë¯¸ìŠ¤(resolved promise)ë¡œ ê°’ì„ ê°ì‹¸ ì´í–‰ëœ í”„ë¼ë¯¸ìŠ¤ê°€ ë°˜í™˜ë˜ë„ë¡ í•©ë‹ˆë‹¤.

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” await í‚¤ì›Œë“œë¥¼ ë§Œë‚˜ë©´ í”„ë¼ë¯¸ìŠ¤ê°€ ì²˜ë¦¬ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤. ê²°ê³¼ëŠ” ê·¸ ì´í›„ ë°˜í™˜ë©ë‹ˆë‹¤.

await ë’¤ì— ì˜¤ëŠ” ë…€ì„ì€ promiseë¥¼ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.

```javascript
async function f() {
  let promise = new Promise((resolve, reject) => {
    setTimeout(() => resolve("ì™„ë£Œ!"), 1000)
  })

  let result = await promise // í”„ë¼ë¯¸ìŠ¤ê°€ ì´í–‰ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼ (*)

  alert(result) // "ì™„ë£Œ!"
}

f()
```

í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³ , í•¨ìˆ˜ ë³¸ë¬¸ì´ ì‹¤í–‰ë˜ëŠ” ë„ì¤‘ì— (\*)ë¡œ í‘œì‹œí•œ ì¤„ì—ì„œ ì‹¤í–‰ì´ ì ì‹œ `ì¤‘ë‹¨` ë˜ì—ˆë‹¤ê°€ í”„ë¼ë¯¸ìŠ¤ê°€ ì²˜ë¦¬ë˜ë©´ ì‹¤í–‰ì´ ì¬ê°œë©ë‹ˆë‹¤. ì´ë•Œ í”„ë¼ë¯¸ìŠ¤ ê°ì²´ì˜ result ê°’ì´ ë³€ìˆ˜ resultì— í• ë‹¹ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ìœ„ ì˜ˆì‹œë¥¼ ì‹¤í–‰í•˜ë©´ 1ì´ˆ ë’¤ì— 'ì™„ë£Œ!'ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.

awaitëŠ” ë§ ê·¸ëŒ€ë¡œ í”„ë¼ë¯¸ìŠ¤ê°€ ì²˜ë¦¬ë  ë•Œê¹Œì§€ í•¨ìˆ˜ ì‹¤í–‰ì„ ê¸°ë‹¤ë¦¬ê²Œ ë§Œë“­ë‹ˆë‹¤. í”„ë¼ë¯¸ìŠ¤ê°€ ì²˜ë¦¬ë˜ë©´ ê·¸ ê²°ê³¼ì™€ í•¨ê»˜ ì‹¤í–‰ì´ ì¬ê°œë˜ì£ . **í”„ë¼ë¯¸ìŠ¤ê°€ ì²˜ë¦¬ë˜ê¸¸ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆì—” ì—”ì§„ì´ ë‹¤ë¥¸ ì¼(ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰, ì´ë²¤íŠ¸ ì²˜ë¦¬ ë“±)ì„ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, CPU ë¦¬ì†ŒìŠ¤ê°€ ë‚­ë¹„ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

awaitëŠ” promise.thenë³´ë‹¤ ì¢€ ë” ì„¸ë ¨ë˜ê²Œ í”„ë¼ë¯¸ìŠ¤ì˜ result ê°’ì„ ì–»ì„ ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ë¬¸ë²•ì…ë‹ˆë‹¤. promise.thenë³´ë‹¤ ê°€ë…ì„± ì¢‹ê³  ì“°ê¸°ë„ ì‰½ìŠµë‹ˆë‹¤.

---

## ê·¸ë˜ì„œ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í–ˆì–´?

- íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ” í•¨ìˆ˜ í•˜ë‚˜ë¥¼ ë§Œë“¤ê³  ì—‘ì…€ì„ ì—…ë¡œë“œ ë°›ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì— ì ìš©

```javascript
// fileì„ ì½ì–´ì„œ worksheetë¥¼ ë°˜í™˜í•˜ëŠ” Promise ë°˜í™˜ í•¨ìˆ˜ ìƒì„±.
const excelFileReadFnc = (file) => {
  const reader = new FileReader();
  reader.readAsBinaryString(file);

  const workwheet = new Promise((resolve, reject) => {
    reader.onload = (e) => {
      // ... íŒŒì¼ ì½ì–´ì˜¤ëŠ” ë™ì‘

      resolve(ì½ì–´ì˜¨ ë°ì´í„°);
    };
  });
  return workwheet;
};
```

```javascript
// async await ìœ¼ë¡œ worksheet return ë°›ì•„ ì‚¬ìš©.
const worksheet = await excelFileReadFnc(file)
```
